---
slug: /paas
sidebar_position: 3
---

# راهنمای بخش کانتینر ابری

## کانتینر ابری

کانتینر ابری (Cloud Container) یک محیط توسعه و استقرار کامل اپلیکیشن‌ها در محیط ابری است. شما می‌توانید به کمک Cloud Container، از برنامه‌های ساده مبتنی بر ابر تا برنامه‌های کاربردی سازمانی پیچیده را بر بستر ابری ارائه دهید. Cloud Container برای پشتیبانی از چرخه عمر کامل برنامه وب طراحی شده است: ساخت، آزمایش، استقرار، مدیریت و به‌روز‌رسانی.

سرویس Cloud Container به شما امکان می‌دهد از هزینه و پیچیدگی خرید و مدیریت مجوزهای نرم‌افزار، زیرساخت‌های برنامه کاربردی و میان‌افزار، سازمان‌دهندگان کانتینر مانند کوبرنتیز یا ابزارهای توسعه و سایر منابع جلوگیری کنید. شما برنامه‌ها و سرویس‌هایی را که توسعه می‌دهید مدیریت می‌کنید، و ارائه‌دهنده خدمات ابری معمولاً چیزهای دیگر را مدیریت می‌کند.

پس از ورود به صفحه کانتینر با صفحه پیشخوان مواجه می‌شوید:

![paas_projects_list](/img/container/paas_projects_list.png)

از طریق منو کنار می‌توانید وارد صفحه پروژه‌های من شوید:

![paas-3.png](/img/container/paas-3.png)

با کلیک بر روی **ایجاد پروژه** می‌توانید پروژه جدید بسازید و در آن به ساخت اپلیکیشن خود بپردازید. 

:::warning نکته
در نام پروژه از کاراکترهای خاص (!_=+/@#$%^&*) استفاده نکنید!
تنها استفاده از کاراکتر خط تیره "-" مجاز است.
:::


![paas-4.png](/img/container/paas-4.png)

پس از انتخاب نام برای پروژه خود که در واقع namespace مربوطه در Kubernetes است، می‌توانیم برای ساخت اپلیکیشن خود اقدام کنیم. با کلیک بر روی **اپلیکیشن‌های من** از منو کناری وارد صفحه مربوطه می‌شوید و لیست اپلیکیشن‌های خود را می‌توانید مشاهده کنید:

![paas-6.png](/img/container/paas-6.png)     

در این صفحه مواردی را می‌بینیم که جداگانه در ادامه توضیح داده می‌شود.
در قسمت بالا سمت چپ می‌توانیم لیست پروژه‌های خود را ملاحظه بفرمایید و بین پروژه‌ها جا‌به‌جا شوید.

![paas-7.png](/img/container/paas-7.png)  

با کلیک بر روی **ایجاد اپلیکیشن** در صفحه اپلیکیشن‌های من، جهت ساخت اپلیکیشن انتخاب‌های زیر را دارید:

![paas-10.png](/img/container/paas-10.png)

در کانتینر ایمیج شما می‌توانید ایمیج، فایل پیکربندی، سکرت، متغیرهای محلی و تمام موارد مورد نیاز برای راه‌اندازی اپلیکیشن خود را انتخاب کنید.
در سرویس کاتالوگ نرم افزارهای آماده‌ای برای شما لیست شده است و می‌توانید آن‌ها را انتخاب کنید و در این مورد میزان باز بودن دست شما برای تغییر کمتر است و برای افرادی مناسب است که آشنایی زیادی نداشته باشند و صرفا راه اندازی ساده نرم افزار مدنظرشان باشد.

### کانتینر ایمیج

در صفحه کانتینر ایمیج شما با موارد زیر رو به روی می‌شوید:

![paas-11.png](/img/container/paas-11.png)

نام اپلیکیشن در واقع name است که در قسمت metadata زده می‌شود و به صورت ساده تر به نوعی نام اپلیکیشن شما را تعیین می‌کند.
در نوع اپلیکیشن، دو نوع وجود دارد که در
[تفاوت Deployment و StatefulSet در کوبرنتیز](https://virgool.io/Abriment/%D8%AA%D9%81%D8%A7%D9%88%D8%AA-deployment-%D9%88-statefulset-%D8%AF%D8%B1-%DA%A9%D9%88%D8%A8%D8%B1%D9%86%D8%AA%DB%8C%D8%B3-wql4aiea1e97)
 میتوانید تفاوت آن‌ها را متوجه شوید.
همچنین تعداد پادهایی که نیاز دارید را می‌توانید با تعداد رپلیکا مشخص کنید. برای مواردی که می‌خواهید کلاستر داشته باشید و HA داشته باشید و یا برای مواردی مثل شاردینگ و Horizontal Scaling مورد استفاده می‌تواند قرار بگیرد.

![paas-12.png](/img/container/paas-12.png)

در قسمت مشخصات ایمیج شما آدرس رجیستری و اسم ایمیج و تگ مربوط به آن را وارد می‌کنید و اگر ایمیج شما عمومی نباشد و خصوصی باشد باید ابتدا سکرتی را بسازید و بعد در این صفحه به آن ارجاع دهید که ساختن سکرت را در ادامه به آن خواهیم پرداخت. با فعال کردن ایمیج اختصاصی شما نیاز دارید سکرت مورد نظرتان را انتخاب کنید که به صورت اتوماتیک نام کاربری و رمز عبور رجیستری خارجی جاگذاری می-شود.

![paas-13.png](/img/container/paas-13.png)

در ادامه شما باید منابع مورد نیاز برای اپلیکیشن‌تان را انتخاب کنید:

![paas-14.png](/img/container/paas-14.png)

انتخاب منابع می‌تواند از بسته‌های پیشنهادی ابریمنت باشد یا خودتان بسته دلخواهتان را انتخاب کنید. هسته پردازشی CPU، حافظه تصادفی RAM و حافظه میرا ephemeral Storage است.
برای آنکه دیتا شما با ری استارت شدن پاد یا هر اتفاق غیر منتظره‌ای برای پاد از بین نرود نیاز به دیسک دائمی دارید. در قسمت بعدی می‌توانید اگر نیاز به دیسک دارید انتخاب کنید. سه نوع دیسک وجود دارد:

1. `SSD`
2. `HDD`
3. `HDD with SSD cache`

همچنین دو نوع حالت دسترسی وجود دارد:

1. `Read Write Once (RWO)`:

 دیسک فقط به یک پاد persist می‌شود و فقط یک پاد به آن دیسک دسترسی دارد. به عنوان مثال کافکا چون دیتاها نیاز نیست یکسان باشد به ازای هر پاد یک دیسک می‌خواهیم که این حالت دسترسی مناسب است.

2. `Read Write Many (RWX)`: 

یک دیسک می‌تواند در اختیار چند پاد قرار بگیرد و در واقع داده‌ها در مسیر مشخص شده در هر پاد یکسان است. به عنوان مثال گرافانا را اگر در حالت deployment راه اندازی کنیم و بخواهیم اگر برای یک پاد اتفاقی افتاد downtime نداشته باشیم باید دیسک را در حالت RWX قرار دهیم که پاد جدید بالا بیاید و از داده آن دیسک بتواند استفاده کند.

برای هر دیسک همچنین باید مشخص کنیم که به چه مسیری persist شود.

هر پروژه مربوط به کاربر محدودیتی از لحاظ منابع دارد که همان resource quota مربوط به namespace است.

![paas-15.png](/img/container/paas-15.png)

در مرحله بعدی شما می‌توانید تنظیمات و پیکربندی‌های مربوط به اپلیکیشن خودتان را انجام دهید:

1. متغیر‌های محلی (Environment Variable)

![paas-16.png](/img/container/paas-16.png)

متغیر‌های محلی از سه حالت می‌توانند ست شوند:

- `Value`:

 به صورت key-value داده می‌شود.

- `From configMap`: 

پارامتری را که در configmap ست کرده‌اید را value آن را به عنوان مقدار env مربوطه انتخاب می‌کنید. در مواردی کاربردی است که پارامتر‌ها بخواهید همه را در یک کانفیگ مپ قرار دهید و مقادیر را در صورت نیاز در کانفیگ مپ تغییر دهید و اگر چند اپلیکیشن از آن کانفیگ مپ استفاده کنند در همه آن‌ها تغییرات اعمال خواهد شد.

- `From Secret`:

پارامتری را که در سکرت ست کرده‌اید را value آن را به عنوان مقدار env مربوطه انتخاب می‌کنید. در مواردی کاربردی است که نخواهیم مستقیما مقدار قابل دیدن باشد و آن را به صورت base64 در سکرت قرار می‌دهیم و به آن ارجاع می‌دهیم. مثلا پسوورد.

2. فایل پیکربندی

- ConfigMap

در مواردی کاربر دارد که شما config file اپلیکیشن‌تان را در کانفیگ مپ قرار دهید و آن را از این طریق به درون اپلیکیشن و در مسیر مربوطه قرار دهید.
در این قسمت شما یا از قبل کانفیگ مپ مربوطه را ساختید از طریق صفحه مجزا مربوط به کانفیگ مپ در سمت راست صفحه و زیر اپلیکیشن‌های من و به آن در مراحل ساخت ارجاع می‌دهید.

![paas-16.png](/img/container/paas-17.png)

یا قبلا نساخته‌اید و در همین مراحل ساخت می‌خواهید آن را بسازید که در تصاویر روند آن را ملاحظه می‌کنید: 

![paas-18.png](/img/container/paas-19.png)

![paas-19.png](/img/container/paas-20.png)

می‌توانید با کلیک بر روی اضافه کردن مقادیر، کلید اضافه کنید و در یک configMap چند کلید داشته باشید و به کلید و مقادیر متناظر مختلف ارجاع دهید.

- Secret File

این مورد هم مانند کانفیگ مپ است اما کاربر آن همانطور که در قبل هم اشاره کردیم برای آن است که نخواهیم مستقیما مقدار قابل دیدن باشد و آن را به صورت base64 در سکرت قرار می‌دهیم و به آن ارجاع می‌دهیم. 

![paas-20.png](/img/container/paas-21.png)

Secret‌ها انواع مختلفی دارند:

![paas-21.png](/img/container/paas-22.png)

    - Key/Value
    - Image Pull Secret
    - Basic Authntication
    - SSH Authentication
    - TLS


- زیردامنه رایگان

قسسمت زیردامنه رایگان در واقع برای مواردی است که اپلیکیشن شما UI دارد و روی یک پورتی راه اندازی می‌شود. برای دسترسی به آن از بیرون از زیردامنه رایگان استفاده می‌کنید و آدرس دامنه و پورت اپلیکشن که بر روی آن UI دارد را می‌دهید. زیردامنه رایگان در واقع همان Ingress در کوبرنتیز است.

![paas-20.png](/img/container/paas-23.png)

-  سرویس‌ها

سرویس‌ها در واقع برای expose کردن یک پورت و ارتباط با اپلیکیشن در درون ابریمنت است. سرویس Headless هم برای دسترسی که یک پاد پشت StatefulSet یا Deployment است در صورتی که سرویس عادی درخواست را بین پادها Load Balance می‌کند.

![paas-21.png](/img/container/paas-24.png)     

- فایل YAML
در قسمت بعدی در واقع yaml فایل ساخته شده با اطلاعات‌تان را می‌توایند مشاهده کنید و آن را تغییر دهید. در واقع این yaml فایل به شما قابلیت اضافه کردن موارد مورد نیازتان و تغییر را می‌دهد و در واقع مانیفست کوبرنتیز است و حتی می‌توانید این yaml را کپی کنید در کلاستر دیگر کوبرنتیزی استفاده کنید.

![paas-22.png](/img/container/paas-25.png)   

بعد از ساخته شدن اپلیکیشن، می‌توانید اطلاعات مربوط به آن را مشاهده کنید :

![paas-23.png](/img/container/paas-26.png)   

همچنین با کلیک بر روی ... می‌توانید اپلیکیشن خود را راه اندازی مجدد (Restart) ، خاموش (replica=0) و یا حذف (delete) کنید.

![paas-24.png](/img/container/paas-27.png) 

همچنین در این صفحه مجموع منابع مصرف شده و محدودیت‌ها را می‌توانید ملاحظه بفرمایید:

![paas-25.png](/img/container/paas-28.png) 

در سمت چپ بالای صفحه شما مقدار شارژ خود را می‌توانید ملاحظه بفرمایید و یا حساب خود را شارژ بفرمایید
 و صورت حساب و قبض شما به صورت PAYG (Pay As You Go) حساب می‌شود.  

لاگ اپلیکیشن خود را می‌توانید با ورود به تب سمت راست صفحه مشاهده کنید پس از کلیک بر روی لاگ اپلیکیشن وارد صفحه زیر می‌شوید:

![paas-27.png](/img/container/paas-30.png) 

همچنین می‌توانید فیلتر‌های زمانی و سرچ روی آن بزنید:

![paas-28.png](/img/container/paas-31.png) 

در قسمت مانتورینگ دو بخش وجود دارد:

1. داشبورد
متریک‌هایی که در داشبورد مانیتور شده و به کاربر ارائه می‌شوند در ادامه خواهد آمد:
اطلاعات در سطح پروژه:

- مموری مصرف شده (به صورت درصدی gauge)

- پردازنده مصرف شده (به صورت درصدی gauge)

- فضای ذخیره سازی مصرف شده (به صورت درصدی gauge)

- تعداد پادها

- تعداد پادهای در حال اجرا

- دفعات راه اندازی دوباره صندوقچه‌ها

اطلاعات در سطح پاد:

- مموری مصرف شده پاد ( به صورت مقدار مصرف، درصد نسبت به منابع انتخابی کاربر، حداقل و حداکثر و میانه مصرف(

- پردازنده مصرف شده  ( به صورت مقدار مصرف، درصد نسبت به منابع انتخابی کاربر، حداقل و حداکثر و میانه مصرف(

- فضای ذخیره سازی پاد  ( به صورت مقدار مصرف، درصد نسبت به منابع انتخابی کاربر، حداقل و حداکثر و میانه
 مصرف(

- ورودی/خروجی شبکه پاد  ( به صورت مقدار مصرف، حداقل و حداکثر و میانه مصرف(

در این قسمت نیز شما توانایی انتخاب پروژه و فیلتر کردن و انتخاب پاد‌ها را دارید همچنین فیلتر زمانی و امکان فعال سازی به روز رسانی خودکار هم دارید.

2. کوئری سفارشی    

در این قسمت اگر شما متریکی را برای پروژه‌تان نیاز دارید که در داشبورد مانیتورینگ ارائه شده ما نبود می‌توانید در قسمت کوئری سفارسی کوئری PromQL آن را وارد کنید و به صورت Histogram مقادیر را ملاحظه کنید.

![paas-29.png](/img/container/paas-32.png)   


آیکون زنگوله بالا، نشان دهنده لاگ‌های موجود در هنگام راه‌اندازی اپلیکیشن است که در واقع event‌های مخصوص به پروژه یا همان namespace شما بر روی کوبرنتیز است.

![paas-8.png](/img/container/paas-8.png)

### ساخت اپلیکیشن به روش CI/CD

